@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═══════════════════════════════════════════════════════════
   GEIST-INSPIRED DESIGN SYSTEM — Light Theme (Default)
   ═══════════════════════════════════════════════════════════ */
:root {
  /* ─── Spacing ──────────────────────────────── */
  --geist-space: 4px;
  --geist-space-2x: 8px;
  --geist-space-3x: 12px;
  --geist-space-4x: 16px;
  --geist-space-6x: 24px;
  --geist-space-8x: 32px;
  --geist-space-gap: 24px;
  --geist-space-gap-half: 12px;
  --geist-space-gap-quarter: 6px;
  --geist-page-margin: 24px;
  --geist-page-width: 1200px;
  --ds-page-width: 1400px;
  --geist-radius: 6px;
  --geist-marketing-radius: 8px;

  /* ─── Layout ───────────────────────────────── */
  --header-height: 64px;
  --sidebar-width: 260px;
  --grid-cell-padding: 48px;

  /* ─── Light Theme Gray Scale ───────────────── */
  --ds-gray-100: hsl(0, 0%, 95%);
  --ds-gray-200: hsl(0, 0%, 92%);
  --ds-gray-300: hsl(0, 0%, 90%);
  --ds-gray-400: hsl(0, 0%, 92%);
  --ds-gray-500: hsl(0, 0%, 79%);
  --ds-gray-600: hsl(0, 0%, 66%);
  --ds-gray-700: hsl(0, 0%, 56%);
  --ds-gray-800: hsl(0, 0%, 49%);
  --ds-gray-900: hsl(0, 0%, 40%);
  --ds-gray-1000: hsl(0, 0%, 9%);

  /* ─── Light Theme Blue ─────────────────────── */
  --ds-blue-100: hsl(212, 100%, 97%);
  --ds-blue-200: hsl(210, 100%, 96%);
  --ds-blue-300: hsl(210, 100%, 94%);
  --ds-blue-400: hsl(209, 100%, 90%);
  --ds-blue-500: hsl(209, 100%, 80%);
  --ds-blue-600: hsl(208, 100%, 66%);
  --ds-blue-700: hsl(212, 100%, 48%);
  --ds-blue-800: hsl(212, 100%, 41%);
  --ds-blue-900: hsl(211, 100%, 42%);
  --ds-blue-1000: hsl(211, 100%, 15%);

  /* ─── Light Theme Red ──────────────────────── */
  --ds-red-100: hsl(0, 100%, 97%);
  --ds-red-200: hsl(0, 100%, 96%);
  --ds-red-300: hsl(0, 100%, 95%);
  --ds-red-400: hsl(0, 90%, 92%);
  --ds-red-500: hsl(0, 82%, 85%);
  --ds-red-600: hsl(359, 90%, 71%);
  --ds-red-700: hsl(358, 75%, 59%);
  --ds-red-800: hsl(358, 70%, 52%);
  --ds-red-900: hsl(358, 66%, 48%);
  --ds-red-1000: hsl(355, 49%, 15%);

  /* ─── Light Theme Amber ────────────────────── */
  --ds-amber-100: hsl(39, 100%, 95%);
  --ds-amber-200: hsl(44, 100%, 92%);
  --ds-amber-300: hsl(43, 96%, 90%);
  --ds-amber-400: hsl(42, 100%, 78%);
  --ds-amber-500: hsl(38, 100%, 71%);
  --ds-amber-600: hsl(36, 90%, 62%);
  --ds-amber-700: hsl(39, 100%, 57%);
  --ds-amber-800: hsl(35, 100%, 52%);
  --ds-amber-900: hsl(30, 100%, 32%);
  --ds-amber-1000: hsl(20, 79%, 17%);

  /* ─── Light Theme Green ────────────────────── */
  --ds-green-100: hsl(120, 60%, 96%);
  --ds-green-200: hsl(120, 60%, 95%);
  --ds-green-300: hsl(120, 60%, 91%);
  --ds-green-400: hsl(122, 60%, 86%);
  --ds-green-500: hsl(124, 60%, 75%);
  --ds-green-600: hsl(125, 60%, 64%);
  --ds-green-700: hsl(131, 41%, 46%);
  --ds-green-800: hsl(132, 43%, 39%);
  --ds-green-900: hsl(133, 50%, 32%);
  --ds-green-1000: hsl(128, 29%, 15%);

  /* ─── Semantic Colors ──────────────────────── */
  --geist-foreground: #000;
  --geist-background: #fff;
  --ds-background-100: #fff;
  --ds-background-200: #fafafa;
  --geist-selection: var(--ds-gray-1000);
  --geist-selection-text-color: var(--ds-gray-100);
  --geist-link-color: var(--ds-blue-700);

  /* ─── Accents ──────────────────────────────── */
  --accents-1: #fafafa;
  --accents-2: #eaeaea;
  --accents-3: #999;
  --accents-4: #888;
  --accents-5: #666;
  --accents-6: #444;
  --accents-7: #333;
  --accents-8: #111;

  /* ─── Shadows ──────────────────────────────── */
  --shadow-smallest: 0px 2px 4px rgba(0, 0, 0, 0.05);
  --shadow-small: 0 5px 10px rgba(0, 0, 0, 0.12);
  --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
  --shadow-large: 0 30px 60px rgba(0, 0, 0, 0.12);
  --ds-shadow-border-base: 0 0 0 1px rgba(0, 0, 0, 0.08);
  --ds-shadow-border: var(--ds-shadow-border-base);
  --ds-shadow-small: 0px 1px 2px rgba(0, 0, 0, 0.04);
  --ds-shadow-border-small: var(--ds-shadow-border-base), var(--ds-shadow-small);

  /* ─── Gradients ────────────────────────────── */
  --geist-text-gradient: linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, #000 100%);
}

/* ═══════════════════════════════════════════════════════════
   DARK THEME
   ═══════════════════════════════════════════════════════════ */
.dark {
  --ds-gray-100: hsl(0, 0%, 10%);
  --ds-gray-200: hsl(0, 0%, 12%);
  --ds-gray-300: hsl(0, 0%, 16%);
  --ds-gray-400: hsl(0, 0%, 18%);
  --ds-gray-500: hsl(0, 0%, 27%);
  --ds-gray-600: hsl(0, 0%, 53%);
  --ds-gray-700: hsl(0, 0%, 56%);
  --ds-gray-800: hsl(0, 0%, 49%);
  --ds-gray-900: hsl(0, 0%, 63%);
  --ds-gray-1000: hsl(0, 0%, 93%);

  --ds-blue-100: hsl(216, 50%, 12%);
  --ds-blue-200: hsl(214, 59%, 15%);
  --ds-blue-300: hsl(213, 71%, 20%);
  --ds-blue-400: hsl(212, 78%, 23%);
  --ds-blue-500: hsl(211, 86%, 27%);
  --ds-blue-600: hsl(206, 100%, 50%);
  --ds-blue-700: hsl(212, 100%, 48%);
  --ds-blue-800: hsl(212, 100%, 41%);
  --ds-blue-900: hsl(210, 100%, 66%);
  --ds-blue-1000: hsl(206, 100%, 96%);

  --ds-red-100: hsl(357, 37%, 12%);
  --ds-red-200: hsl(357, 46%, 16%);
  --ds-red-300: hsl(356, 54%, 22%);
  --ds-red-400: hsl(357, 55%, 26%);
  --ds-red-500: hsl(357, 60%, 32%);
  --ds-red-600: hsl(358, 75%, 59%);
  --ds-red-700: hsl(358, 75%, 59%);
  --ds-red-800: hsl(358, 69%, 52%);
  --ds-red-900: hsl(358, 100%, 69%);
  --ds-red-1000: hsl(353, 90%, 96%);

  --ds-amber-100: hsl(35, 100%, 8%);
  --ds-amber-200: hsl(32, 100%, 10%);
  --ds-amber-300: hsl(33, 100%, 15%);
  --ds-amber-400: hsl(35, 100%, 17%);
  --ds-amber-500: hsl(35, 91%, 22%);
  --ds-amber-600: hsl(39, 85%, 49%);
  --ds-amber-700: hsl(39, 100%, 57%);
  --ds-amber-800: hsl(35, 100%, 52%);
  --ds-amber-900: hsl(39, 90%, 50%);
  --ds-amber-1000: hsl(40, 94%, 93%);

  --ds-green-100: hsl(136, 50%, 9%);
  --ds-green-200: hsl(137, 50%, 12%);
  --ds-green-300: hsl(136, 50%, 14%);
  --ds-green-400: hsl(135, 70%, 16%);
  --ds-green-500: hsl(135, 70%, 23%);
  --ds-green-600: hsl(135, 70%, 34%);
  --ds-green-700: hsl(131, 41%, 46%);
  --ds-green-800: hsl(132, 43%, 39%);
  --ds-green-900: hsl(131, 43%, 57%);
  --ds-green-1000: hsl(136, 73%, 94%);

  --geist-foreground: #fff;
  --geist-background: #000;
  --ds-background-100: #000;
  --ds-background-200: #0a0a0a;
  --geist-link-color: var(--ds-blue-900);

  --accents-1: #111;
  --accents-2: #333;
  --accents-3: #444;
  --accents-4: #666;
  --accents-5: #888;
  --accents-6: #999;
  --accents-7: #eaeaea;
  --accents-8: #fafafa;

  --shadow-smallest: 0 0 0 1px var(--accents-2);
  --shadow-small: 0 0 0 1px var(--accents-2);
  --shadow-medium: 0 0 0 1px var(--accents-2);
  --shadow-large: 0 0 0 1px var(--accents-2);
  --ds-shadow-border-base: 0 0 0 1px rgba(255, 255, 255, 0.145);
  --ds-shadow-border: var(--ds-shadow-border-base);
  --ds-shadow-small: 0px 1px 2px rgba(0, 0, 0, 0.16);
  --ds-shadow-border-small: var(--ds-shadow-border-base), var(--ds-shadow-small);

  --geist-text-gradient: linear-gradient(180deg, #fff 0%, rgba(255, 255, 255, 0.75) 100%);
}

/* ═══════════════════════════════════════════════════════════
   BASE LAYER
   ═══════════════════════════════════════════════════════════ */
@layer base {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    touch-action: manipulation;
    text-rendering: optimizelegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-feature-settings: 'rlig' 1, 'calt' 1;
    font-synthesis: none;
    scroll-padding-top: var(--header-height);
    scroll-behavior: smooth;
    color-scheme: dark;
  }

  html.light {
    color-scheme: light;
  }

  body {
    font-family: var(--font-geist-sans, system-ui, -apple-system, sans-serif);
    background-color: var(--geist-background);
    color: var(--ds-gray-1000);
    max-width: 100vw;
    min-height: 100vh;
    margin: 0;
    line-height: 1.5;
    overflow-x: hidden;
  }

  ::selection {
    background-color: var(--ds-gray-1000);
    color: var(--ds-gray-100);
  }

  a {
    color: var(--geist-link-color);
    text-decoration: none;
  }

  a:hover {
    text-decoration: underline;
  }

  /* ── Focus Visible — Global a11y ────────────── */
  :focus {
    outline: none;
  }

  :focus-visible {
    outline: 2px solid var(--ds-blue-700);
    outline-offset: 2px;
    border-radius: 4px;
  }

  [tabindex="-1"]:focus-visible {
    outline: none;
  }

  /* ── Skip Navigation — a11y ─────────────────── */
  .skip-nav-link {
    position: absolute;
    top: -100px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 600;
    background: var(--ds-blue-700);
    color: #fff;
    border-radius: var(--geist-radius);
    transition: top 0.2s ease;
    white-space: nowrap;
  }

  .skip-nav-link:focus {
    top: 8px;
  }

  /* ── Reduced Motion — a11y ──────────────────── */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  /* ── SR Only — a11y ─────────────────────────── */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  /* ── Live Region for Screen Readers ─────────── */
  .sr-announce {
    position: absolute;
    width: 1px;
    height: 1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--ds-gray-400);
    border-radius: 3px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--ds-gray-500);
  }

  /* ── Smooth number transitions ──────────────── */
  .tabular-nums {
    font-variant-numeric: tabular-nums;
  }

  /* ── Heading Scale ──────────────────────────── */
  h1 { font-size: 2rem; line-height: 1.2; letter-spacing: -0.02em; }
  h2 { font-size: 1.5rem; line-height: 1.3; letter-spacing: -0.015em; }
  h3 { font-size: 1.25rem; line-height: 1.4; letter-spacing: -0.01em; }
  h4 { font-size: 1.125rem; line-height: 1.4; }
  h5 { font-size: 1rem; line-height: 1.5; }
  h6 { font-size: 0.875rem; line-height: 1.5; }
}

/* ═══════════════════════════════════════════════════════════
   COMPONENT LAYER
   ═══════════════════════════════════════════════════════════ */
@layer components {
  /* ─── Card ─────────────────────────────────── */
  .geist-card {
    @apply rounded-[var(--geist-radius)] transition-all;
    background: var(--ds-background-100);
    box-shadow: var(--ds-shadow-border-small);
    transition: box-shadow 0.2s cubic-bezier(0.22, 1, 0.36, 1),
                transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .geist-card:hover {
    box-shadow: var(--shadow-medium);
  }

  .geist-card-interactive {
    @apply rounded-[var(--geist-radius)] cursor-pointer;
    background: var(--ds-background-100);
    box-shadow: var(--ds-shadow-border-small);
    transition: box-shadow 0.2s cubic-bezier(0.22, 1, 0.36, 1),
                transform 0.2s cubic-bezier(0.22, 1, 0.36, 1),
                background 0.15s ease;
  }

  .geist-card-interactive:hover {
    box-shadow: var(--shadow-medium);
    transform: translateY(-2px);
  }

  .geist-card-interactive:active {
    transform: translateY(0) scale(0.995);
  }

  .geist-card-flat {
    @apply rounded-[var(--geist-radius)];
    background: var(--ds-background-100);
    border: 1px solid var(--ds-gray-400);
  }

  /* ─── Stack Layout ─────────────────────────── */
  .stack {
    display: flex;
    flex-direction: var(--stack-direction, column);
    align-items: var(--stack-align, stretch);
    justify-content: var(--stack-justify, flex-start);
    padding: var(--stack-padding, 0);
    gap: var(--stack-gap, 0);
  }

  /* ─── Grid System ──────────────────────────── */
  .grid-system {
    width: 100%;
    display: inherit;
    justify-content: inherit;
    align-items: inherit;
    container-type: inline-size;
  }

  /* ─── Container ────────────────────────────── */
  .geist-container {
    max-width: var(--geist-page-width);
    margin: 0 auto;
    padding: 0 var(--geist-page-margin);
    width: 100%;
  }

  .ds-container {
    max-width: var(--ds-page-width);
    margin: 0 auto;
    padding: 0 var(--geist-page-margin);
    width: 100%;
  }

  /* ─── Button Variants (Geist Style) ────────── */
  .btn-geist {
    @apply inline-flex items-center justify-center gap-2 font-medium;
    border-radius: var(--geist-radius);
    font-size: 14px;
    height: 40px;
    padding: 0 16px;
    outline: none;
    cursor: pointer;
    border: none;
    position: relative;
    overflow: hidden;
    isolation: isolate;
    transition: background 0.15s ease,
                color 0.15s ease,
                box-shadow 0.15s ease,
                opacity 0.15s ease,
                transform 0.1s ease;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
  }

  .btn-geist:active:not(:disabled) {
    transform: scale(0.97);
  }

  .btn-geist:focus-visible {
    box-shadow: 0 0 0 2px var(--geist-background), 0 0 0 4px var(--ds-blue-700);
  }

  /* Ripple effect layer */
  .btn-geist .ripple-effect {
    position: absolute;
    border-radius: 50%;
    background: currentColor;
    opacity: 0.15;
    pointer-events: none;
    animation: ripple 0.6s linear;
  }

  .btn-geist-primary {
    background: var(--geist-foreground);
    color: var(--geist-background);
  }

  .btn-geist-primary:hover:not(:disabled) {
    opacity: 0.88;
  }

  .btn-geist-secondary {
    background: var(--ds-background-100);
    color: var(--ds-gray-1000);
    box-shadow: var(--ds-shadow-border);
  }

  .btn-geist-secondary:hover:not(:disabled) {
    background: var(--ds-gray-100);
  }

  .btn-geist-error {
    background: var(--ds-red-700);
    color: #fff;
  }

  .btn-geist-error:hover:not(:disabled) {
    opacity: 0.88;
  }

  .btn-geist-warning {
    background: var(--ds-amber-700);
    color: #000;
  }

  .btn-geist-warning:hover:not(:disabled) {
    opacity: 0.88;
  }

  .btn-geist-ghost {
    background: transparent;
    color: var(--ds-gray-900);
  }

  .btn-geist-ghost:hover:not(:disabled) {
    background: var(--ds-gray-200);
  }

  .btn-geist-success {
    background: var(--ds-green-700);
    color: #fff;
  }

  .btn-geist-success:hover:not(:disabled) {
    opacity: 0.88;
  }

  .btn-geist-sm {
    height: 32px;
    padding: 0 12px;
    font-size: 13px;
  }

  .btn-geist-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
  }

  .btn-geist-xl {
    height: 56px;
    padding: 0 32px;
    font-size: 18px;
    border-radius: var(--geist-marketing-radius);
  }

  .btn-geist-icon {
    width: 40px;
    padding: 0;
  }

  .btn-geist-icon.btn-geist-sm {
    width: 32px;
  }

  /* ─── Input (Geist Style) ──────────────────── */
  .input-geist {
    @apply w-full;
    height: 40px;
    padding: 0 12px;
    font-size: 14px;
    line-height: 1.5;
    border-radius: var(--geist-radius);
    background: var(--ds-background-100);
    color: var(--ds-gray-1000);
    box-shadow: var(--ds-shadow-border);
    border: none;
    outline: none;
    transition: box-shadow 0.15s ease,
                background 0.15s ease;
  }

  .input-geist::placeholder {
    color: var(--ds-gray-700);
    transition: color 0.15s ease;
  }

  .input-geist:hover:not(:focus):not(:disabled) {
    box-shadow: 0 0 0 1px var(--ds-gray-600);
  }

  .input-geist:focus {
    box-shadow: 0 0 0 1px var(--ds-blue-700), 0 0 0 4px var(--ds-blue-200);
  }

  .input-geist:focus::placeholder {
    color: var(--ds-gray-600);
  }

  .input-geist:disabled {
    background: var(--ds-gray-100);
    color: var(--ds-gray-700);
    cursor: not-allowed;
    opacity: 0.7;
  }

  .input-geist[aria-invalid="true"],
  .input-geist.input-error {
    box-shadow: 0 0 0 1px var(--ds-red-700);
  }

  .input-geist[aria-invalid="true"]:focus,
  .input-geist.input-error:focus {
    box-shadow: 0 0 0 1px var(--ds-red-700), 0 0 0 4px var(--ds-red-200);
  }

  .input-geist.input-success {
    box-shadow: 0 0 0 1px var(--ds-green-700);
  }

  /* ─── Textarea ─────────────────────────────── */
  textarea.input-geist {
    height: auto;
    min-height: 80px;
    padding: 10px 12px;
    resize: vertical;
    line-height: 1.6;
  }

  /* ─── Select ─────────────────────────────────── */
  select.input-geist {
    appearance: none;
    padding-right: 36px;
    background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%23888' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
  }

  /* ─── Badge (Geist Style) ──────────────────── */
  .badge-geist {
    @apply inline-flex items-center font-medium;
    font-size: 12px;
    height: 24px;
    padding: 0 8px;
    border-radius: 999px;
    transition: background 0.15s ease;
    white-space: nowrap;
  }

  .badge-geist-sm {
    height: 20px;
    font-size: 11px;
    padding: 0 6px;
  }

  .badge-geist-blue {
    background: var(--ds-blue-200);
    color: var(--ds-blue-900);
  }

  .badge-geist-green {
    background: var(--ds-green-200);
    color: var(--ds-green-900);
  }

  .badge-geist-red {
    background: var(--ds-red-200);
    color: var(--ds-red-900);
  }

  .badge-geist-amber {
    background: var(--ds-amber-200);
    color: var(--ds-amber-900);
  }

  .badge-geist-gray {
    background: var(--ds-gray-200);
    color: var(--ds-gray-900);
  }

  /* ─── Table (Geist Style) ──────────────────── */
  .table-geist {
    @apply w-full text-sm;
    border-collapse: separate;
    border-spacing: 0;
  }

  .table-geist thead th {
    @apply text-left font-medium;
    color: var(--ds-gray-900);
    padding: 8px 16px;
    font-size: 13px;
    border-bottom: 1px solid var(--ds-gray-400);
    background: var(--ds-background-200);
    position: sticky;
    top: 0;
    z-index: 1;
    white-space: nowrap;
    user-select: none;
  }

  .table-geist thead th[data-sortable] {
    cursor: pointer;
  }

  .table-geist thead th[data-sortable]:hover {
    color: var(--ds-gray-1000);
  }

  .table-geist tbody td {
    padding: 12px 16px;
    border-bottom: 1px solid var(--ds-gray-200);
    color: var(--ds-gray-1000);
  }

  .table-geist tbody tr {
    transition: background 0.1s ease;
  }

  .table-geist tbody tr:hover {
    background: var(--ds-gray-100);
  }

  .table-geist tbody tr:focus-within {
    background: var(--ds-gray-100);
    box-shadow: inset 2px 0 0 var(--ds-blue-700);
  }

  .table-geist tbody tr[data-selected="true"] {
    background: var(--ds-blue-100);
  }

  /* ─── Skeleton / Shimmer ───────────────────── */
  .skeleton-geist {
    @apply animate-shimmer rounded;
    background: linear-gradient(
      90deg,
      var(--ds-gray-200) 0%,
      var(--ds-gray-300) 50%,
      var(--ds-gray-200) 100%
    );
    background-size: 200% 100%;
  }

  /* ─── Tooltip ──────────────────────────────── */
  .tooltip-geist {
    @apply absolute z-50 rounded px-2.5 py-1.5 text-xs animate-scale-in pointer-events-none;
    background: var(--geist-foreground);
    color: var(--geist-background);
    box-shadow: var(--shadow-small);
    max-width: 250px;
    word-wrap: break-word;
  }

  .tooltip-geist::after {
    content: '';
    position: absolute;
    width: 6px;
    height: 6px;
    background: inherit;
    transform: rotate(45deg);
  }

  .tooltip-geist[data-placement="top"]::after {
    bottom: -3px;
    left: 50%;
    margin-left: -3px;
  }

  .tooltip-geist[data-placement="bottom"]::after {
    top: -3px;
    left: 50%;
    margin-left: -3px;
  }

  /* ─── Divider ──────────────────────────────── */
  .divider-geist {
    height: 1px;
    width: 100%;
    background: var(--ds-gray-400);
  }

  /* ─── Text Gradient ────────────────────────── */
  .text-gradient {
    background: var(--geist-text-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* ─── Toggle / Switch ──────────────────────── */
  .switch-geist {
    @apply relative inline-flex items-center cursor-pointer;
    width: 44px;
    height: 24px;
    border-radius: 12px;
    background: var(--ds-gray-400);
    transition: background 0.2s ease;
    border: none;
    padding: 0;
  }

  .switch-geist[aria-checked="true"],
  .switch-geist.active {
    background: var(--ds-blue-700);
  }

  .switch-geist::after {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    border-radius: 10px;
    background: white;
    left: 2px;
    transition: transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  }

  .switch-geist[aria-checked="true"]::after,
  .switch-geist.active::after {
    transform: translateX(20px);
  }

  /* ─── Progress Bar ─────────────────────────── */
  .progress-geist {
    @apply relative w-full overflow-hidden rounded-full;
    height: 4px;
    background: var(--ds-gray-300);
  }

  .progress-geist-bar {
    @apply h-full rounded-full;
    background: var(--ds-blue-700);
    transition: width 0.5s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .progress-geist-indeterminate .progress-geist-bar {
    width: 30%;
    animation: indeterminate 1.2s ease-in-out infinite;
  }

  @keyframes indeterminate {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(400%); }
  }

  /* ─── Avatar ───────────────────────────────── */
  .avatar-geist {
    @apply inline-flex items-center justify-center rounded-full overflow-hidden flex-shrink-0;
    background: var(--ds-gray-300);
    color: var(--ds-gray-900);
    font-weight: 600;
  }

  .avatar-geist-sm { width: 28px; height: 28px; font-size: 11px; }
  .avatar-geist-md { width: 36px; height: 36px; font-size: 13px; }
  .avatar-geist-lg { width: 48px; height: 48px; font-size: 16px; }
  .avatar-geist-xl { width: 64px; height: 64px; font-size: 20px; }

  .avatar-group {
    @apply flex -space-x-2;
  }

  .avatar-group .avatar-geist {
    border: 2px solid var(--ds-background-100);
  }

  /* ─── Breadcrumb ───────────────────────────── */
  .breadcrumb-geist {
    @apply flex items-center gap-1.5 text-[13px];
  }

  .breadcrumb-geist a {
    color: var(--ds-gray-800);
    text-decoration: none;
    transition: color 0.15s ease;
  }

  .breadcrumb-geist a:hover {
    color: var(--ds-gray-1000);
    text-decoration: none;
  }

  .breadcrumb-geist .current {
    color: var(--ds-gray-1000);
    font-weight: 500;
  }

  .breadcrumb-geist .separator {
    color: var(--ds-gray-600);
  }

  /* ─── Command Palette ──────────────────────── */
  .cmdk-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 9998;
    animation: fade-in 0.15s ease;
  }

  .cmdk-dialog {
    position: fixed;
    top: 20%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    width: min(640px, calc(100vw - 32px));
    border-radius: 12px;
    overflow: hidden;
    background: var(--ds-background-100);
    border: 1px solid var(--ds-gray-400);
    box-shadow: var(--shadow-large);
    animation: scale-in 0.2s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .cmdk-input {
    @apply w-full text-base;
    padding: 16px 20px;
    background: transparent;
    color: var(--ds-gray-1000);
    border: none;
    border-bottom: 1px solid var(--ds-gray-400);
    outline: none;
  }

  .cmdk-input::placeholder {
    color: var(--ds-gray-700);
  }

  .cmdk-list {
    max-height: 320px;
    overflow-y: auto;
    padding: 8px;
  }

  .cmdk-item {
    @apply flex items-center gap-3 rounded-lg cursor-pointer;
    padding: 10px 12px;
    font-size: 14px;
    color: var(--ds-gray-1000);
    transition: background 0.1s ease;
  }

  .cmdk-item:hover,
  .cmdk-item[data-active="true"] {
    background: var(--ds-gray-200);
  }

  .cmdk-item-icon {
    @apply flex-shrink-0;
    color: var(--ds-gray-700);
  }

  .cmdk-kbd {
    @apply inline-flex items-center justify-center text-2xs font-mono;
    min-width: 22px;
    height: 22px;
    padding: 0 5px;
    border-radius: 4px;
    background: var(--ds-gray-200);
    color: var(--ds-gray-800);
    border: 1px solid var(--ds-gray-400);
  }

  /* ─── Toast with Progress ──────────────────── */
  .toast-geist {
    @apply rounded-lg overflow-hidden;
    background: var(--ds-background-100);
    border: 1px solid var(--ds-gray-400);
    box-shadow: var(--shadow-medium);
    animation: slide-in-right 0.35s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .toast-geist-exit {
    animation: slide-out-right 0.25s ease-in forwards;
  }

  .toast-progress {
    height: 2px;
    transform-origin: left;
    animation: toast-progress linear forwards;
  }

  /* ─── Empty State ──────────────────────────── */
  .empty-state {
    @apply flex flex-col items-center justify-center text-center py-16 px-6;
  }

  .empty-state-icon {
    @apply mb-4;
    color: var(--ds-gray-600);
  }

  .empty-state-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--ds-gray-1000);
    margin-bottom: 4px;
  }

  .empty-state-description {
    font-size: 14px;
    color: var(--ds-gray-800);
    max-width: 400px;
  }

  /* ─── Stagger Children Animation ───────────── */
  .stagger-children > * {
    animation: stagger-in 0.4s cubic-bezier(0.22, 1, 0.36, 1) both;
  }

  .stagger-children > *:nth-child(1) { animation-delay: 0ms; }
  .stagger-children > *:nth-child(2) { animation-delay: 50ms; }
  .stagger-children > *:nth-child(3) { animation-delay: 100ms; }
  .stagger-children > *:nth-child(4) { animation-delay: 150ms; }
  .stagger-children > *:nth-child(5) { animation-delay: 200ms; }
  .stagger-children > *:nth-child(6) { animation-delay: 250ms; }
  .stagger-children > *:nth-child(7) { animation-delay: 300ms; }
  .stagger-children > *:nth-child(8) { animation-delay: 350ms; }

  /* ─── Kbd ──────────────────────────────────── */
  kbd {
    @apply inline-flex items-center justify-center text-2xs font-mono;
    min-width: 22px;
    height: 22px;
    padding: 0 5px;
    border-radius: 4px;
    background: var(--ds-gray-200);
    color: var(--ds-gray-800);
    border: 1px solid var(--ds-gray-400);
    box-shadow: 0 1px 0 var(--ds-gray-400);
  }

  /* ─── Form Error Animation ─────────────────── */
  .form-error-shake {
    animation: shake 0.35s ease-in-out;
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-4px); }
    40% { transform: translateX(4px); }
    60% { transform: translateX(-3px); }
    80% { transform: translateX(2px); }
  }

  /* ─── Dropdown ─────────────────────────────── */
  .dropdown-geist {
    @apply rounded-lg overflow-hidden;
    background: var(--ds-background-100);
    border: 1px solid var(--ds-gray-400);
    box-shadow: var(--shadow-medium);
    min-width: 180px;
    animation: scale-in 0.15s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .dropdown-geist-item {
    @apply flex items-center gap-2.5 text-[13px] cursor-pointer;
    padding: 8px 12px;
    color: var(--ds-gray-1000);
    transition: background 0.1s ease;
  }

  .dropdown-geist-item:hover {
    background: var(--ds-gray-200);
  }

  .dropdown-geist-item:focus-visible {
    background: var(--ds-gray-200);
    outline: none;
  }

  .dropdown-geist-separator {
    height: 1px;
    background: var(--ds-gray-400);
    margin: 4px 0;
  }

  /* ─── Page Transition ──────────────────────── */
  .page-enter {
    animation: fade-in-up 0.4s cubic-bezier(0.22, 1, 0.36, 1) both;
  }
}

/* ═══════════════════════════════════════════════════════════
   RESPONSIVE GRID CELLS
   ═══════════════════════════════════════════════════════════ */
@media (max-width: 960px) {
  :root {
    --grid-cell-padding: 24px;
  }
}

@media (max-width: 640px) {
  :root {
    --geist-page-margin: 16px;
    --sidebar-width: 0px;
  }
}

/* ═══════════════════════════════════════════════════════════
   UTILITY LAYER
   ═══════════════════════════════════════════════════════════ */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  .text-pretty {
    text-wrap: pretty;
  }

  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }

  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* ─── Glass Effect ─────────────────────────── */
  .glass {
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
  }

  html.light .glass {
    background: rgba(255, 255, 255, 0.6);
  }

  /* ─── Gradient Border ──────────────────────── */
  .gradient-border {
    position: relative;
    overflow: hidden;
  }

  .gradient-border::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(135deg, var(--ds-blue-700), var(--ds-green-700));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  /* ─── Animated Background Dots ─────────────── */
  .bg-dots {
    background-image: radial-gradient(var(--ds-gray-400) 1px, transparent 1px);
    background-size: 24px 24px;
  }

  /* ─── Animated Background Grid ─────────────── */
  .bg-grid {
    background-image:
      linear-gradient(var(--ds-gray-300) 1px, transparent 1px),
      linear-gradient(90deg, var(--ds-gray-300) 1px, transparent 1px);
    background-size: 40px 40px;
  }

  /* ─── Truncate Multi-line ──────────────────── */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* ─── Custom Scrollbar ─────────────────────── */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: var(--ds-gray-400);
    border-radius: 3px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--ds-gray-600);
  }

  /* ─── Hover Lift ───────────────────────────── */
  .hover-lift {
    transition: transform 0.2s cubic-bezier(0.22, 1, 0.36, 1),
                box-shadow 0.2s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .hover-lift:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-medium);
  }

  /* ─── Focus Ring ───────────────────────────── */
  .focus-ring:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--geist-background), 0 0 0 4px var(--ds-blue-700);
  }

  /* ─── Animation Delay Utilities ────────────── */
  .delay-75 { animation-delay: 75ms; }
  .delay-100 { animation-delay: 100ms; }
  .delay-150 { animation-delay: 150ms; }
  .delay-200 { animation-delay: 200ms; }
  .delay-300 { animation-delay: 300ms; }
  .delay-500 { animation-delay: 500ms; }

  /* ─── Reduced Motion ───────────────────────── */
  .motion-safe\:animate-none {
    animation: none !important;
  }

  @media (prefers-reduced-motion: no-preference) {
    .motion-safe\:animate-none {
      animation: revert !important;
    }
  }
}
